#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define rep(i,n) for(int i = 0; i < n; ++i)
#define rep2(i,start,end) for(ll i = start; i < end; ++i)
#define dwn(i,n) for(int i = n; i >= 0; --i)
#define dwn2(i,start,end) for(ll i = start; i >= end; --i)
#define pll pair<ll,ll>
#define mk(x,y) make_pair(x,y)
#define pdl pair<double, ll>
const ll N = 4e5 + 200;
const ll INF = 0x3f3f3f;
const ll mode = 1e9 + 7;

ll f[N][22];
ll query(ll l, ll r){
	ll k = log2(r-l+1);
	return max(f[l][k], f[r - (1<<k) + 1][k]);
}
void st(ll n){
	rep2(i,1,21){
		for(int j = 1; j + (1<<i) <= n+1; j++){
			f[j][i] = max(f[j][i-1], f[j+(1<<(i-1))][i-1]);
		}
	}
}
int main(){
	ll n,q;
	cin>>n>>q;
	rep2(i,1,n+1){
		scanf("%lld",&f[i][0]);
	}
	st(n);
	while(q--){
		ll l,r;
		scanf("%lld%lld",&l,&r);
		printf("%lld\n",query(l,r));
	}
	return 0;
}






